import RPi.GPIO as GPIO
import mysql.connector
import time
import os
import serial
from luma.core.interface.serial import spi
from luma.oled.device import ssd1306
from luma.core.render import canvas
from datetime import datetime
from multiprocessing import Process
from flask import Flask, render_template, jsonify

app = Flask(__name__)

BASE_DIR = os.path.dirname(os.path.abspath(__file__))
TEMPLATES_DIR = os.path.join(BASE_DIR, 'templates')
FILE_PATH = os.path.join(TEMPLATES_DIR, 'file_motion.txt')

spi_serial = spi(device=0, port=0)
oled = ssd1306(spi_serial, rotate=2)
oled.command(0xA0)
oled.command(0xC8)

def Db_connection():
    try:
        connection = mysql.connector.connect(
            host='localhost',
            user='Embedded_act',
            password='bet1234',
            database='mydatabase'
        )
        print("Database connection successful")
        return connection
    except mysql.connector.Error as err:
        print(f"Database connection error: {err}")
        return None
